{"extVersion":"1.29.9","name":"Instagram - Scraper","icon":"riGlobalLine","table":[],"version":"1.29.9","drawflow":{"edges":[{"data":{},"id":"vueflow__edge-TDhFBgucG2u4lY8WChlAgTDhFBgucG2u4lY8WChlAg-output-1-0iimd650iimd65-input-1","label":"","markerEnd":"arrowclosed","selectable":true,"source":"TDhFBgucG2u4lY8WChlAg","sourceHandle":"TDhFBgucG2u4lY8WChlAg-output-1","sourceX":315.99985447357847,"sourceY":360.99997103222097,"target":"0iimd65","targetHandle":"0iimd65-input-1","targetX":338.86383013440087,"targetY":445.58104872411553,"type":"custom","updatable":true},{"data":{},"id":"vueflow__edge-nh1swr2nh1swr2-output-1-e353hg2e353hg2-input-1","label":"","markerEnd":"arrowclosed","selectable":true,"source":"nh1swr2","sourceHandle":"nh1swr2-output-1","sourceX":3430.7847191971514,"sourceY":789.642324407857,"target":"e353hg2","targetHandle":"e353hg2-input-1","targetX":3819.6240776937893,"targetY":757.8076910584441,"type":"custom","updatable":true},{"class":"connected-edges","data":{},"id":"vueflow__edge-e2l61xce2l61xc-output-1-351xige351xige-input-1","label":"","markerEnd":"arrowclosed","selectable":true,"source":"e2l61xc","sourceHandle":"e2l61xc-output-1","sourceX":1420.269166968089,"sourceY":396.52752577162516,"target":"yf5o3bw","targetHandle":"yf5o3bw-input-1","targetX":1244.5687801765014,"targetY":657.5669075527533,"type":"custom","updatable":true},{"data":{},"id":"vueflow__edge-351xige351xige-output-1-0wosnr50wosnr5-input-1","label":"","markerEnd":"arrowclosed","selectable":true,"source":"351xige","sourceHandle":"351xige-output-1","sourceX":1753.225471901721,"sourceY":209.27569298027458,"target":"0wosnr5","targetHandle":"0wosnr5-input-1","targetX":1726.2434138484225,"targetY":-30.766799130197832,"type":"custom","updatable":true},{"data":{},"id":"vueflow__edge-0wosnr50wosnr5-output-1-znox5jbznox5jb-input-1","label":"","markerEnd":"arrowclosed","selectable":true,"source":"0wosnr5","sourceHandle":"0wosnr5-output-1","sourceX":1966.2432966939239,"sourceY":-30.766799130197832,"target":"tes75o9","targetHandle":"tes75o9-input-1","targetX":1707.1673053204365,"targetY":-324.52045477623307,"type":"custom","updatable":true},{"data":{},"id":"vueflow__edge-yf5o3bwyf5o3bw-output-1-351xige351xige-input-1","label":"","markerEnd":"arrowclosed","selectable":true,"source":"yf5o3bw","sourceHandle":"yf5o3bw-output-1","sourceX":1484.5686630220027,"sourceY":657.5669075527533,"target":"351xige","targetHandle":"351xige-input-1","targetX":1513.2255890562196,"targetY":209.27569298027458,"type":"custom","updatable":true},{"data":{},"id":"vueflow__edge-0iimd650iimd65-output-1-e2l61xce2l61xc-input-1","label":"","markerEnd":"arrowclosed","selectable":true,"source":"0iimd65","sourceHandle":"0iimd65-output-1","sourceX":578.8636270391021,"sourceY":445.58104872411553,"target":"8ukjaax","targetHandle":"8ukjaax-input-1","targetX":1068.8335878948856,"targetY":-33.22641627929353,"type":"custom","updatable":true},{"data":{},"id":"vueflow__edge-znox5jbznox5jb-output-1-gwdpjodgwdpjod-input-1","label":"","markerEnd":"arrowclosed","selectable":true,"source":"znox5jb","sourceHandle":"znox5jb-output-1","sourceX":2295.308145440088,"sourceY":-304.1926745314463,"target":"rpagq94","targetHandle":"rpagq94-input-1","targetX":2339.862038658472,"targetY":-302.60296062486964,"type":"custom","updatable":true},{"data":{},"id":"vueflow__edge-gwdpjodgwdpjod-output-1-pe6gdx3pe6gdx3-input-1","label":"","markerEnd":"arrowclosed","selectable":true,"source":"gwdpjod","sourceHandle":"gwdpjod-output-1","sourceX":2624.5529436030592,"sourceY":-68.96795196955506,"target":"pe6gdx3","targetHandle":"pe6gdx3-input-1","targetX":2781.7945408393107,"targetY":-5.331838556771618,"type":"custom","updatable":true},{"data":{},"id":"vueflow__edge-rpagq94rpagq94-output-1-gwdpjodgwdpjod-input-1","label":"","markerEnd":"arrowclosed","selectable":true,"source":"rpagq94","sourceHandle":"rpagq94-output-1","sourceX":2579.86180691624,"sourceY":-302.60296062486964,"target":"gwdpjod","targetHandle":"gwdpjod-input-1","targetX":2384.5529461698243,"targetY":-68.96795196955506,"type":"custom","updatable":true},{"data":{},"id":"vueflow__edge-pe6gdx3pe6gdx3-output-1-b73js56b73js56-input-1","label":"","markerEnd":"arrowclosed","selectable":true,"source":"pe6gdx3","sourceHandle":"pe6gdx3-output-1","sourceX":3021.7943090970784,"sourceY":-5.331838556771618,"target":"ejlqcvk","targetHandle":"ejlqcvk-input-1","targetX":3056.810090757603,"targetY":-53.022396346070764,"type":"custom","updatable":true},{"data":{},"id":"vueflow__edge-b73js56b73js56-output-L2r9fQHE4ynD6chCXpjtp-nh1swr2nh1swr2-input-1","label":"","markerEnd":"arrowclosed","selectable":true,"source":"b73js56","sourceHandle":"b73js56-output-L2r9fQHE4ynD6chCXpjtp","sourceX":3350.696389520573,"sourceY":315.8503795545229,"target":"nh1swr2","targetHandle":"nh1swr2-input-1","targetX":3190.7849509393836,"targetY":789.642324407857,"type":"custom","updatable":true},{"class":"connected-edges","data":{},"id":"vueflow__edge-b73js56b73js56-output-fallback-e353hg2e353hg2-input-1","label":"","markerEnd":"arrowclosed","selectable":true,"source":"b73js56","sourceHandle":"b73js56-output-fallback","sourceX":3349.696496958032,"sourceY":357.85033610285427,"target":"e353hg2","targetHandle":"e353hg2-input-1","targetX":3819.6240776937893,"targetY":757.8076910584441,"type":"custom","updatable":true},{"data":{},"id":"vueflow__edge-tes75o9tes75o9-output-1-znox5jbznox5jb-input-1","label":"","markerEnd":"arrowclosed","selectable":true,"source":"tes75o9","sourceHandle":"tes75o9-output-1","sourceX":1947.1670735782043,"sourceY":-324.52045477623307,"target":"znox5jb","targetHandle":"znox5jb-input-1","targetX":2055.3083771823203,"targetY":-304.1926745314463,"type":"custom","updatable":true},{"data":{},"id":"vueflow__edge-ejlqcvkejlqcvk-output-1-b73js56b73js56-input-1","label":"","markerEnd":"arrowclosed","selectable":true,"source":"ejlqcvk","sourceHandle":"ejlqcvk-output-1","sourceX":3296.810088190838,"sourceY":-53.022396346070764,"target":"1dnrmit","targetHandle":"1dnrmit-input-1","targetX":2414.425745344904,"targetY":387.27589531813237,"type":"custom","updatable":true},{"class":"connected-edges","data":{},"id":"vueflow__edge-8ukjaax8ukjaax-output-1-enxma4venxma4v-input-1","label":"","markerEnd":"arrowclosed","selectable":true,"source":"8ukjaax","sourceHandle":"8ukjaax-output-1","sourceX":1308.833470740387,"sourceY":-33.22641627929353,"target":"enxma4v","targetHandle":"enxma4v-input-1","targetX":479.1449759415569,"targetY":1019.7610428578569,"type":"custom","updatable":true},{"class":"connected-edges","data":{},"id":"vueflow__edge-enxma4venxma4v-output-1-e2l61xce2l61xc-input-1","label":"","markerEnd":"arrowclosed","selectable":true,"source":"enxma4v","sourceHandle":"enxma4v-output-1","sourceX":719.1448587870582,"sourceY":1019.7610428578569,"target":"e2l61xc","targetHandle":"e2l61xc-input-1","targetX":1180.2692841225876,"targetY":396.52752577162516,"type":"custom","updatable":true},{"data":{},"id":"vueflow__edge-1dnrmit1dnrmit-output-1-vssbn2ivssbn2i-input-1","label":"","markerEnd":"arrowclosed","selectable":true,"source":"1dnrmit","sourceHandle":"1dnrmit-output-1","sourceX":2654.425742778139,"sourceY":387.27589531813237,"target":"vssbn2i","targetHandle":"vssbn2i-input-1","targetX":2684.8602822709986,"targetY":412.0365563357845,"type":"custom","updatable":true},{"class":"connected-edges","data":{},"id":"vueflow__edge-vssbn2ivssbn2i-output-1-b73js56b73js56-input-1","label":"","markerEnd":"arrowclosed","selectable":true,"source":"vssbn2i","sourceHandle":"vssbn2i-output-1","sourceX":2924.8602797042336,"sourceY":412.0365563357845,"target":"b73js56","targetHandle":"b73js56-input-1","targetX":3045.696729433626,"targetY":305.25662900450175,"type":"custom","updatable":true},{"class":"source-gwdpjod-output-fallback target-ejlqcvk-input-1","data":{},"id":"vueflow__edge-gwdpjodgwdpjod-output-fallback-ejlqcvkejlqcvk-input-1","label":"","markerEnd":"arrowclosed","selectable":true,"source":"gwdpjod","sourceHandle":"gwdpjod-output-fallback","sourceX":2624.5529436030592,"sourceY":-46.96797012598143,"target":"ejlqcvk","targetHandle":"ejlqcvk-input-1","targetX":3056.810090757603,"targetY":-53.022396346070764,"type":"custom","updatable":true}],"nodes":[{"data":{"activeInInput":false,"contextMenuName":"","contextTypes":[],"date":"","days":[],"delay":5,"description":"","disableBlock":false,"interval":60,"isUrlRegex":false,"observeElement":{"baseElOptions":{"attributeFilter":[],"attributes":false,"characterData":false,"childList":true,"subtree":false},"baseSelector":"","matchPattern":"","selector":"","targetOptions":{"attributeFilter":[],"attributes":false,"characterData":false,"childList":true,"subtree":false}},"parameters":[],"preferParamsInTab":false,"shortcut":"","time":"00:00","type":"manual","url":""},"id":"TDhFBgucG2u4lY8WChlAg","initialized":false,"label":"trigger","position":{"x":100,"y":325},"type":"BlockBasic"},{"data":{"code":"automaSetVariable('sheet',['1Ib9_TdgUPHeIX3S7TVO3iKqSx_7neeoZ_sY4nuZaM7Q','Sheet1'])\n\nautomaSetVariable('whitelist', [\n\"Musician/band\",\n\"Artist\",\n\"Musician\",\n\"Entrepreneur\",\n\"Rapper\",\n\"MGMT\",\n\"OUT NOW\",\n\"distrokid.com\",\n\"youtube.com\",\n\"linktr\"\n])\nautomaNextBlock()","context":"background","description":"","disableBlock":false,"everyNewTab":false,"preloadScripts":[],"runBeforeLoad":false,"timeout":20000},"id":"0iimd65","initialized":false,"label":"javascript-code","position":{"x":362.86380121245696,"y":409.5810203980278,"z":0},"type":"BlockBasic"},{"data":{"clearLoop":false,"disableBlock":false,"loopId":"EIY6KG"},"id":"e353hg2","initialized":false,"label":"loop-breakpoint","position":{"x":3843.623790949445,"y":682.2139912937065},"type":"BlockLoopBreakpoint"},{"data":{"InsertDataOption":"INSERT_ROWS","assignVariable":false,"customData":"{{variables.data}}","dataColumn":"","dataFrom":"custom","description":"","disableBlock":false,"firstRowAsKey":false,"keysAsFirstRow":true,"onError":{"dataToInsert":[],"enable":true,"errorMessage":"","insertData":false,"retry":true,"retryInterval":15,"retryTimes":7,"toDo":"error"},"range":"{{variables@sheet.1}}","refKey":"f","saveData":true,"settings":{"blockTimeout":0,"debugMode":false},"spreadsheetId":"{{variables@sheet.0}}","type":"append","valueInputOption":"RAW","variableName":""},"id":"nh1swr2","initialized":false,"label":"google-sheets","position":{"x":3214.7848933705063,"y":753.642353375636},"type":"BlockBasic"},{"data":{"actionElMaxWaitTime":15,"actionElSelector":"","actionPageMaxWaitTime":10,"description":"","disableBlock":false,"findBy":"xpath","loadMoreAction":"scroll","loopId":"EIY6KG","maxLoop":"0","onError":{"dataToInsert":[],"enable":true,"errorMessage":"","insertData":false,"retry":true,"retryInterval":8,"retryTimes":1,"toDo":"error"},"reverseLoop":false,"scrollToBottom":true,"selector":"//div[@role=\"dialog\"]//a[@role=\"link\" and contains(@class,\"notranslate\")]","settings":{"blockTimeout":0,"debugMode":false},"waitForSelector":true,"waitSelectorTimeout":1000},"id":"e2l61xc","initialized":false,"label":"loop-elements","position":{"x":1204.2693411414439,"y":360.5275260924708},"type":"BlockBasic"},{"data":{"description":"","disableBlock":false,"findBy":"cssSelector","incX":false,"incY":false,"markEl":true,"multiple":false,"onError":{"dataToInsert":[],"enable":true,"errorMessage":"","insertData":false,"retry":false,"retryInterval":8,"retryTimes":1,"toDo":"error"},"scrollIntoView":true,"scrollX":0,"scrollY":0,"selector":"{{loopData@EIY6KG}}","settings":{"blockTimeout":0,"debugMode":false},"smooth":true,"waitForSelector":true,"waitSelectorTimeout":1000},"id":"351xige","initialized":false,"label":"element-scroll","position":{"x":1537.225646075076,"y":173.27569330112024},"type":"BlockBasic"},{"data":{"description":"","disableBlock":false,"disableMultiple":true,"findBy":"cssSelector","markEl":true,"onError":{"dataToInsert":[],"enable":true,"errorMessage":"","insertData":false,"retry":true,"retryInterval":8,"retryTimes":1,"toDo":"error"},"openInNewTab":true,"selector":"{{loopData@EIY6KG}}","settings":{"blockTimeout":0,"debugMode":false},"waitForSelector":true,"waitSelectorTimeout":1000},"id":"0wosnr5","initialized":false,"label":"link","position":{"x":1750.2434708672788,"y":-66.76678090501882},"type":"BlockBasic"},{"data":{"disableBlock":false},"id":"znox5jb","initialized":false,"label":"active-tab","position":{"x":2079.308319613443,"y":-340.19264556366727},"type":"BlockBasic"},{"data":{"disableBlock":false},"id":"yf5o3bw","initialized":false,"label":"active-tab","position":{"x":1268.5688371953577,"y":621.5669365205323},"type":"BlockBasic"},{"data":{"addExtraRow":false,"assignVariable":true,"dataColumn":"","description":"","disableBlock":false,"extraRowDataColumn":"","extraRowValue":"","findBy":"xpath","includeTags":false,"markEl":false,"multiple":false,"onError":{"dataToInsert":[{"name":"text","type":"variable","value":""}],"enable":true,"errorMessage":"","insertData":true,"retry":true,"retryInterval":8,"retryTimes":1,"toDo":"fallback"},"prefixText":"","regex":"","regexExp":[],"saveData":false,"selector":"(//main//header/div/section)[2]","settings":{"blockTimeout":0,"debugMode":false},"suffixText":"","useTextContent":true,"variableName":"text","waitForSelector":true,"waitSelectorTimeout":1000},"id":"gwdpjod","initialized":false,"label":"get-text","position":{"x":2408.553117776414,"y":-116.9679300260041},"type":"BlockBasic"},{"data":{"code":"function checkArrayMatch(arr, text){\n    text = text.toLowerCase();\n    return arr.some(x => text.includes(x.toLowerCase()));\n}\nif(checkArrayMatch(automaRefData('variables', 'whitelist'),automaRefData('variables', 'text') )){\n automaSetVariable('data', [[automaRefData('variables', 'url')]])\n}else{\n   automaSetVariable('data','')\n}\nautomaNextBlock()","context":"background","description":"","disableBlock":false,"everyNewTab":false,"preloadScripts":[],"runBeforeLoad":false,"timeout":20000},"id":"pe6gdx3","initialized":false,"label":"javascript-code","position":{"x":2805.7944832704334,"y":-41.331816750725935},"type":"BlockBasic"},{"data":{"assignVariable":true,"dataColumn":"","description":"","disableBlock":false,"qMatchPatterns":"","qTitle":"","saveData":false,"type":"active-tab","variableName":"url"},"id":"rpagq94","initialized":false,"label":"tab-url","position":{"x":2363.861981089595,"y":-338.602960304024},"type":"BlockBasic"},{"data":{"conditions":[{"conditions":[{"conditions":[{"id":"E7mmwWZZOTbLk2bRxUIvF","items":[{"category":"value","data":{"code":"\nreturn automaRefData('variables', 'data')!=\"\";","context":"background"},"id":"C_juCF311qrXL34XnesoC","type":"code"}]}],"id":"yCoXaKnIUndN1rz8eU3lT"}],"id":"L2r9fQHE4ynD6chCXpjtp","name":"Path 1"}],"description":"","disableBlock":false,"retryConditions":false,"retryCount":10,"retryTimeout":1000},"id":"b73js56","initialized":false,"label":"conditions","position":{"x":3069.6966718647486,"y":226.66293643587375},"type":"BlockConditions"},{"data":{"disableBlock":false,"time":"2000"},"id":"tes75o9","initialized":false,"label":"delay","position":{"x":1731.1672477515592,"y":-383.1141475740365},"type":"BlockDelay"},{"data":{"disableBlock":false},"id":"8ukjaax","initialized":false,"label":"active-tab","position":{"x":1092.8335303260083,"y":-69.22639447324785},"type":"BlockBasic"},{"data":{"activeTab":true,"allWindows":false,"closeType":"tab","description":"","disableBlock":false,"url":""},"id":"ejlqcvk","initialized":false,"label":"close-tab","position":{"x":3080.810033188726,"y":-89.02237454002508},"type":"BlockBasic"},{"data":{"disableBlock":false},"id":"vssbn2i","initialized":false,"label":"active-tab","position":{"x":2708.8602247021213,"y":376.0365566566301},"type":"BlockBasic"},{"data":{"disableBlock":false,"time":"3000"},"id":"1dnrmit","initialized":false,"label":"delay","position":{"x":2438.425916951494,"y":328.6821738733955},"type":"BlockDelay"},{"data":{"code":"function scrollLoadUntilStop(xpath, callback, opts) {\n    // opts: { inactivityMs: 15000, scrollIntervalMs: 700, maxScrollAttempts: 200, maxItems: Infinity }\n    opts = Object.assign({ \n        inactivityMs: 15000, \n        scrollIntervalMs: 700, \n        maxScrollAttempts: 200,\n        maxItems: Infinity // New option added here: default is no limit\n    }, opts || {});\n\n    let lastCount = 0;\n    let lastChangeTime = Date.now();\n    let scrollAttempts = 0;\n    let stopped = false;\n\n    // helper to evaluate snapshot length\n    function getCount() {\n        try {\n            const snap = document.evaluate(xpath, document, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);\n            return snap ? snap.snapshotLength : 0;\n        } catch (e) {\n            return 0;\n        }\n    }\n\n    // call finish and cleanup\n    function finish() {\n        if (stopped) return;\n        stopped = true;\n        if (observer) observer.disconnect();\n        clearInterval(scroller);\n        callback(lastCount);\n    }\n\n    // MutationObserver: watch for DOM changes and update count immediately\n    const observer = new MutationObserver(() => {\n        const cnt = getCount();\n        if (cnt > lastCount) {\n            lastCount = cnt;\n            lastChangeTime = Date.now();\n            \n            // Check for maxItems limit immediately after a change\n            if (opts.maxItems !== Infinity && cnt >= opts.maxItems) {\n                finish();\n            }\n        }\n    });\n    try {\n        observer.observe(document.documentElement || document.body, { childList: true, subtree: true });\n    } catch (e) {\n        // fallback: continue without observer if observe fails\n    }\n\n    // periodic scroller / checker\n    const scroller = setInterval(() => {\n        if (stopped) return;\n\n        const cnt = getCount();\n\n        // 1. Check for maxItems limit at the start of the interval\n        if (opts.maxItems !== Infinity && cnt >= opts.maxItems) {\n            finish();\n            return;\n        }\n\n        // if we have matches, scroll the last matched element into view\n        if (cnt > 0) {\n            try {\n                const snap = document.evaluate(xpath, document, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);\n                const lastEl = snap.snapshotItem(cnt - 1);\n                if (lastEl && typeof lastEl.scrollIntoView === \"function\") {\n                    // prefer end so new items load after it\n                    lastEl.scrollIntoView({ behavior: \"auto\", block: \"start\" });\n                } else {\n                    window.scrollTo(0, document.body.scrollHeight);\n                }\n            } catch (e) {\n                window.scrollTo(0, document.body.scrollHeight);\n            }\n        } else {\n            // no matches yet — scroll page down to try to load items\n            window.scrollBy(0, window.innerHeight || 1000);\n        }\n\n        // update counts if changed by scroll-triggered loading\n        if (cnt > lastCount) {\n            lastCount = cnt;\n            lastChangeTime = Date.now();\n            \n            // 2. Check for maxItems limit after a potential change\n            if (opts.maxItems !== Infinity && cnt >= opts.maxItems) {\n                finish();\n                return;\n            }\n        }\n\n        scrollAttempts++;\n        // safety: if too many scroll attempts\n        if (scrollAttempts >= opts.maxScrollAttempts) {\n            finish();\n            return;\n        }\n\n        // stop when inactivity threshold reached\n        if (Date.now() - lastChangeTime >= opts.inactivityMs) {\n            finish();\n            return;\n        }\n    }, opts.scrollIntervalMs);\n}\nscrollLoadUntilStop('//div[@role=\"dialog\"]//a[@role=\"link\" and contains(@class,\"notranslate\")]', function(finalTotal){\n  automaNextBlock()\n    console.log(\"Finished — total items loaded:\", finalTotal);\n    // proceed with scraping / processing here\n},{maxItems:300});\n","context":"website","description":"","disableBlock":false,"everyNewTab":false,"preloadScripts":[],"runBeforeLoad":false,"timeout":300000},"id":"enxma4v","initialized":false,"label":"javascript-code","position":{"x":503.1449756665463,"y":983.7610718256359},"type":"BlockBasic"},{"data":{"InsertDataOption":"INSERT_ROWS","assignVariable":false,"customData":"[[\"good\"]]","dataColumn":"","dataFrom":"custom","description":"","disableBlock":false,"firstRowAsKey":false,"keysAsFirstRow":true,"onError":{"dataToInsert":[],"enable":true,"errorMessage":"","insertData":false,"retry":true,"retryInterval":15,"retryTimes":7,"toDo":"error"},"range":"Sheet3","refKey":"f","saveData":true,"settings":{"blockTimeout":0,"debugMode":false},"spreadsheetId":"1w2QSVhdw8qWxDiDlyQ2WsvM5sxqrEZ8PfXtR0FtwY1k","type":"update","valueInputOption":"RAW","variableName":""},"id":"lw1bsbf","initialized":false,"label":"google-sheets","position":{"x":3369.919664405307,"y":1089.008160470095},"type":"BlockBasic"},{"data":{"code":"function scrollLoadUntilStop(xpath, callback, opts) {\n    // opts: { inactivityMs: 15000, scrollIntervalMs: 700, maxScrollAttempts: 200 }\n    opts = Object.assign({ inactivityMs: 15000, scrollIntervalMs: 700, maxScrollAttempts: 200 }, opts || {});\n    let lastCount = 0;\n    let lastChangeTime = Date.now();\n    let scrollAttempts = 0;\n    let stopped = false;\n\n    // helper to evaluate snapshot length\n    function getCount() {\n        try {\n            const snap = document.evaluate(xpath, document, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);\n            return snap ? snap.snapshotLength : 0;\n        } catch (e) {\n            return 0;\n        }\n    }\n\n    // call finish and cleanup\n    function finish() {\n        if (stopped) return;\n        stopped = true;\n        if (observer) observer.disconnect();\n        clearInterval(scroller);\n        callback(lastCount);\n    }\n\n    // MutationObserver: watch for DOM changes and update count immediately\n    const observer = new MutationObserver(() => {\n        const cnt = getCount();\n        if (cnt > lastCount) {\n            lastCount = cnt;\n            lastChangeTime = Date.now();\n        }\n    });\n    try {\n        observer.observe(document.documentElement || document.body, { childList: true, subtree: true });\n    } catch (e) {\n        // fallback: continue without observer if observe fails\n    }\n\n    // periodic scroller / checker\n    const scroller = setInterval(() => {\n        if (stopped) return;\n\n        const cnt = getCount();\n\n        // if we have matches, scroll the last matched element into view\n        if (cnt > 0) {\n            try {\n                const snap = document.evaluate(xpath, document, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);\n                const lastEl = snap.snapshotItem(cnt - 1);\n                if (lastEl && typeof lastEl.scrollIntoView === \"function\") {\n                    // prefer end so new items load after it\n                    lastEl.scrollIntoView({ behavior: \"auto\", block: \"start\" });\n                } else {\n                    window.scrollTo(0, document.body.scrollHeight);\n                }\n            } catch (e) {\n                window.scrollTo(0, document.body.scrollHeight);\n            }\n        } else {\n            // no matches yet — scroll page down to try to load items\n            window.scrollBy(0, window.innerHeight || 1000);\n        }\n\n        // update counts if changed by scroll-triggered loading\n        if (cnt > lastCount) {\n            lastCount = cnt;\n            lastChangeTime = Date.now();\n        }\n\n        scrollAttempts++;\n        // safety: if too many scroll attempts without growth and page stopped increasing height, keep checking inactivity timer\n        if (scrollAttempts >= opts.maxScrollAttempts) {\n            finish();\n            return;\n        }\n\n        // stop when inactivity threshold reached\n        if (Date.now() - lastChangeTime >= opts.inactivityMs) {\n            finish();\n            return;\n        }\n    }, opts.scrollIntervalMs);\n}\nscrollLoadUntilStop('//div[@role=\"dialog\"]//a[@role=\"link\" and contains(@class,\"notranslate\")]', function(finalTotal){\n  automaNextBlock()\n    console.log(\"Finished — total items loaded:\", finalTotal);\n    // proceed with scraping / processing here\n});\n","context":"website","description":"","disableBlock":false,"everyNewTab":false,"preloadScripts":[],"runBeforeLoad":false,"timeout":300000},"id":"gc2h1id","initialized":false,"label":"javascript-code","position":{"x":478.04871064168856,"y":1168.9343488703798},"type":"BlockBasic"}],"position":[0,-1],"viewport":{"x":0,"y":-1,"zoom":0.5326496595637554},"zoom":0.5326496595637554},"settings":{"aipowerToken":"","blockDelay":0,"debugMode":false,"defaultColumnName":"column","execContext":"popup","executedBlockOnWeb":false,"inputAutocomplete":true,"insertDefaultColumn":false,"notification":true,"onError":"stop-workflow","publicId":"","restartTimes":3,"reuseLastState":false,"saveLog":true,"tabLoadTimeout":30000},"globalData":"{\n\t\"key\": \"value\"\n}","description":"","includedWorkflows":{}}